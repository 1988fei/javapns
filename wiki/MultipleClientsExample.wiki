#summary Example for sending a message to multiple phones

= Java file =

<code>
import javapns.back.!PushNotificationManager;
import javapns.back.SSLConnectionHelper;
import javapns.data.Device;
import javapns.data.!PayLoad;

 public class Push {
    // APNs Server Host & port
    private static final String HOST = "gateway.sandbox.push.apple.com";
    private static final int PORT = 2195;

     // Badge
    private static final int BADGE = 66;

     private static String certificate = "/absolute/path/to/my/certificate";
    private static String passwd = "mycertificatepassword";

     public static void main( List<User> ) throws Exception {

        System.out.println( "Setting up Push notification" );

        try {
            // Setup up a simple message
            !PayLoad aPayload = new !PayLoad();
            aPayload.addBadge( BADGE );
            System.out.println( "Payload setup successfull." );

             System.out.println ( aPayload );

             // Get !PushNotification Instance
            !PushNotificationManager pushManager = !PushNotificationManager.getInstance();

             // Loop thru our users and add the tokens to the pushManager
            // User is an object, that returns 'username' and 'token' both as Strings
            while ( User user ) {
                    
                pushManager.addDevice( user.getUsername(), user.getToken() );
                System.out.println( "iPhone UDID taken." );

                 System.out.println( "Token: " + pushManager.getDevice( user.getUsername() ).getToken() );
            }

             // Initialize connection
            pushManager.initializeConnection( HOST, PORT, certificate, passwd, SSLConnectionHelper.KEYSTORE_TYPE_PKCS12);
            System.out.println( "Connection initialized..." );

             // Send messages
            while( User user ) {
        
               System.out.println( "Token: " + pushManager.getDevice( user.getUsername() ).getToken() );

                Device client = pushManager.getDevice(user.getUsername());
               pushManager.sendNotification( client, aPayload );
               System.out.println( "Message sent!" );
            }
            System.out.println( "All Messages sent!" );

             System.out.println( "# of attempts: " + pushManager.getRetryAttempts() );
            pushManager.stopConnection();

             System.out.println( "done" );

         } catch (Exception e) {
            e.printStackTrace();
        }
    }
}</code>